language: node_js

node_js:
  - "stable"

services:
  - docker

git:
  depth: 30

sudo:
  false

before_install:

  # Install CouchDB Stable
  - docker run -d -p 3000:5984 klaemo/couchdb:1.6.1

  # Install CouchDB Master
  - docker run -d -p 3001:5984 klaemo/couchdb:2.0-dev --with-haproxy --with-admin-party-please -n 1

  # get the assert.sh framework
  - wget https://raw.github.com/lehmannro/assert.sh/v1.1/assert.sh

  - sleep 10

script:
  - "./test.sh"

matrix:
  include:
    - node_js: "0.10"
      services: docker
    - node_js: "4"
      services: docker

branches:
  only:
  - master
